@{ 
    ViewData["Title"] = "Independent Project";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
  @model IndependentProject.Models.Settlement

   
    <div id="map-canvas"></div>
    <div id="title"></div>
    <script>

      
   d3.csv("https://gist.githubusercontent.com/SamiAljamal/fa10672fd0f01f8199caa6f2f50431bc/raw/50edc161262b02c4f2ebd2470251f151c7cdf9f8/unhcr_2014_data",function(d){
       var dataset = [];
       var onlyValues =[];

     var map = new Datamap({ 
        element: document.getElementById("map-canvas"),
        projection: 'mercator',
        geographyConfig: {
        popupOnHover: false,
        highlightOnHover: false
    },
        fills: {
            defaultFill: '#dddddd',
            'other': 'red'
        }
       
        
    });
           
       Object.keys(d).map(function(key){
           onlyValues.push(parseInt(d[key]["refugees"]))
       });
       console.log(onlyValues);
       var minValue = Math.min.apply(null, onlyValues);
        var maxValue = Math.max.apply(null, onlyValues);

         var sizeScale = d3.scale.linear()
              .domain([minValue, maxValue])
              .range([10, 45]);

              Object.keys(d).forEach(function(key){
                  var refugees= parseInt(d[key]["refugees"]);
                  dataset.push(
                      {
                          country: d[key]["Origin"],
                          centered: d[key]["country_code"],
                          fillKey: "other",
                          population: refugees,
                          radius: sizeScale(refugees)
                      }
                  )
              });
       map.bubbles(dataset, {
        popupTemplate:function (geography, data) { 
             return ['<div class="hoverinfo"><strong>' +  data.country + '</strong>',
            '<br/>Refugees: ' +  data.population +
            '</div>'].join('');
    }
});

   });
    </script>